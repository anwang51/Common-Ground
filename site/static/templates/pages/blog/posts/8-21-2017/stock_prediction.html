<blog-post category="vm.currentPost.category" date="vm.currentPost.date"  name="vm.currentPost.title"  author="vm.currentPost.author"  tags="vm.currentPost.tags" date-path="vm.currentPost.datePath" title-path="vm.currentPost.titlePath">
    <p>One of the latest models to rise to prominence in the deep learning community has been the Long Short Term Memory network, more commonly known as LSTMs. The model is unique in that it is able to handle long-term dependencies. This is especially useful in solving problems that rely on contextual knowledge based on past inputs. More of what LSTMs are capable of can be read on Andrej Karpathy’s blog post, <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">The Unreasonable Effectiveness of Recurrent Neural Networks.</a> </p>
    <p>In this demo, I am tackling a problem of a different nature. I want to explore prospect of predicting stock prices using LSTMs. The beauty of neural networks and deep learning is that the model is able to observe trends and characteristics that are not apparent to humans in order to form its predictions. </p>
    <p>By utilizing a convenient API known as Quandl, it’s quite easy to import the financial time series data for any stock ticker. For this example, I chose FB and used the attributes below as features for the model.</p>
    <img class="blog-post-image" src="templates/pages/blog/posts/{{vm.currentPost.datePath}}/fb_stock_data.png" alt="fb stock data"/>
    <p>Importing the data as a table allows me to process the data as a pandas dataframe. It’s important to normalize the values of each feature so that each feature contributes proportionally to the final prediction. In order to perform cross validation and evaluate training accuracy, the data is split into a training set and testing set. Then using a simple model structure made up of two consecutive LSTM and dropout layers and ending the model with two fully connected layers, I can begin training my model and running it on the test set.</p>
    <img class="blog-post-image" src="templates/pages/blog/posts/{{vm.currentPost.datePath}}/lstm_function.png" alt="lstm function"/>
    <img class="blog-post-image" src="templates/pages/blog/posts/{{vm.currentPost.datePath}}/lstm_structure.png" alt="lstm structure"/>
    <p>This is a visualization of the prediction of the stock for the last 250 days of the stock. As you can see, although the price does not match exactly, there is a general upward and downward trend that is captured by this LSTM model.</p>
    <img class="blog-post-image" src="templates/pages/blog/posts/{{vm.currentPost.datePath}}/results.png" alt="plot of results"/>

    <p>Although it may seem like the model performs with greater accuracy than random guessing, it is important to note that it is the results are rather deceptive. The reason that the model predicts a line resembling the actual performance is because during the prediction process, the model utilizes information from the previous day. Therefore, in order to predict the next day it will readjust to the closing and opening price information from the previous day. As a result, the model tends to heavily overfit to the closing price of the previous day and adjusts itself each day, creating a long term trend that seems predictive. This <a href="http://zacharydavid.com/2017/08/fitting-to-noise-or-nothing-at-all-machine-learning-in-markets/">blog post </a> sums up the problem with predicting stock prices rather well. Without information from the previous day, we cannot predict the next day's prices which makes the model highly limited in terms of usefulness. It can be fascinating to observe the predictive power of deep learning models in awe, but it is always important to evaluate the results with appropriate context and determine whether the results seem feasible. </p>
</blog-post>